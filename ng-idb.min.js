!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(1),i=r(o),u=n(2),s=r(u),a=n(3),c=r(a),d=n(4),l=r(d),f=n(5),h=r(f),p=n(6),$=r(p),v=n(7),m=r(v),g=n(8),y=r(g);n(9),(0,y.default)(angular.module("ng.idb",["ng.v1.idb"])).service("idbEvents",s.default).service("idbUtils",i.default).service("qs",c.default).service("idb",h.default).service("idbModel",$.default).service("idbQuery",m.default).service("idbSocket",l.default)},function(e,t){"use strict";function n(e){"ngInject";function t(e,t){o.array(t)||(t=[t]);for(var n in t){var i=t[n];if("string"==typeof i){if("function"==typeof o[i]){if(o[i](e))return!0}else if(("undefined"==typeof e?"undefined":r(e))==i)return!0}else if("function"==typeof i&&i(args[n]))return!0}return!1}function n(e,n){e=Array.prototype.slice.call(e),"string"==typeof n&&(n=[n]);for(var r in e){var o=e[r],i=n[r];if(i&&!t(o,i)){var u=new Error("Invalid validator to: "+e[r]+" must be "+i);throw u.name="InvalidValidator",u}}}var o={callback:function(e){return"function"==typeof e||null==e||void 0==e},array:function(e){return Array.isArray(e)}};return{validate:n}}n.$inject=["$q"],Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=n},function(e,t){"use strict";function n(){return{DB_ERROR:"cb.error",MODEL_INSTANCED:"model.instanced",MODEL_REPLACE:"model.replace",MODEL_QUERIED:"model.queried",MODEL_UNQUERIED:"model.unqueried"}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(){"ngInject";function e(e){function t(){if(o.length){var e=o.shift();e.apply(null,r.resultArgs),i.push(e),t()}}function n(){if(u.length){var e=u.shift();e.apply(null,r.error),s.push(e),n()}}var r=this,o=[],i=[],u=[],s=[];r.promise={},r.$resolved=!1,r.resolve=function(){r.$resolved||(r.$resolved=!0,r.resultArgs=Array.prototype.slice.call(arguments),t())},r.reject=function(e){r.$resolved||(r.$resolved=!0,r.error=e||{},n())},r.promise.then=function(e){return o.push(e),r.$resolved&&!r.error&&t(),r.promise},r.promise.catch=function(e){return u.push(e),r.$resolved&&r.error&&n(),r.promise},r.promise.done=function(e){return o.push(function(){e.apply(null,[null].concat(r.resultArgs))}),u.push(function(){e.apply(null,r.error)}),r.$resolved&&(r.error?n():t()),r},e&&r.promise.done(e)}return e.defer=function(t){return new e(t)},e.all=function(t){var n=e.defer(),r=o.length,o=Object.keys(t),i=t.length?[]:{};return o.map(function(e){t[e].then(function(t){r--,i[e]=t,r||n.resolve(i)}),t[e].catch(function(e){n.reject(e)})}),n},e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(e,t,n){"ngInject";function r(r,i,u){var s=this;n.validate(arguments,["string",["string","number"],["string","number"]]);var a=[],c=null;r=r||o,s.connect=function(){c=t.connect(r),c.on("connect",function(){e.log("connected"),c.emit("authentication",{id:i,userId:u}),c.on("authenticated",function(){e.log("User is authenticated")})})},s.subscribe=function(e,t){n.validate(arguments,["object",["function","undefined"]]);var r=e.modelName+"."+e.eventName;"number"==typeof e.modelId&&(r=r+"."+e.modelId),c.on(r,t),a.push(r,t)},s.pushListener=function(e,t){n.validate(arguments,["string",["function","undefined"]]),a.push(e)},s.unsubscribe=function(e){c.removeAllListeners(e);var t=a.indexOf(e);t!=-1&&a.splice(t,1)},s.connect()}var o=null;return r.setUrlServer=function(e){o=e},r.setCredentials=function(e,t){e=$accessTokenId,t=$currentUserId},r}n.$inject=["$log","io","idbUtils"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(e,t,n,r,o){"ngInject";function i(i,s,a){var c=this;n.validate(arguments,["string","number",["object","undefined"],["object","undefined"]]);var d={},l=t.defer(),f=t.defer(),h=t.defer(),p=!1,$=null;c.models={},c.bind=function(e,t){n.validate(arguments,["string","function"]),d[e]||(d[e]=[]),d[e].push(t)},c.unbind=function(e,t){if(n.validate(arguments,["string","function"]),d[e]){var r=d[e].indexOf(t);r!=-1&&d[e].splice(r,1)}},c.trigger=function(t,r){n.validate(arguments,["string","object"]),e.log(i+".v"+(s||1)+": "+t);for(var o in d[t])d[t][o].apply(c,r)},c.error=function(e){return c.bind(r.DB_ERROR,e),c},c.open=function(){function t(){var t=u.open(i,s);t.onupgradeneeded=function(e){l.resolve(e,t)},t.onsuccess=function(n){$=t,t.onerror=function(t){e.error("Database error: "+t.target.errorCode),c.trigger(r.DB_ERROR,[t])},f.resolve(n,t)},t.onerror=function(e){f.reject(t.errorCode,e)}}return p?f:(p=!0,u.deleteDatabase(i).onsuccess=t,f)},c.model=function(e,t){n.validate(arguments,["string",["undefined","object"]]);var r=c.models[e];return r||(r=o(c,e,t||a)),c.models[e]=r,r},c.createStore=function(e,t){n.validate(arguments,["string",["object","undefined"]]),l.promise.then(function(n,r){r.result.createObjectStore(e,t)})},c.createIndex=function(e,t,r,o){n.validate(arguments,["string","string","string",["object","undefined"]]),l.promise.then(function(n,i){i.transaction.objectStore(e).createIndex(t,r,o)})},c.transaction=function(e,r,o){n.validate(arguments,["string","string","function"]);var i=t.defer();return f.promise.then(function(t,n){var u=n.result.transaction(e,r),s=o(u);u.oncomplete=function(e){i.resolve(e,s)},u.onabort=function(){i.reject(u.error)}}),i},c.get=function(e,r){n.validate(arguments,["string",["string","number"]]);var o=t.defer();return c.transaction(e,"readonly",function(t){var n=t.objectStore(e).get(r);n.onsuccess=function(e){o.resolve(n.result,e)},n.onerror=function(e){o.reject(e)}}),o},c.put=function(e,r){n.validate(arguments,["string","object"]);var o=t.defer();return c.transaction(e,"readwrite",function(t){var n=t.objectStore(e).put(r);n.onsuccess=function(e){o.resolve(e)},n.onerror=function(e){o.reject(e)}}),o},c.delete=function(e,r){n.validate(arguments,["string",["string","number"]]);var o=t.defer();return c.transaction(e,"readwrite",function(t){var n=t.objectStore(e).delete(r);n.onsuccess=function(e){o.resolve(e)},n.onerror=function(e){o.reject(e)}}),o},c.openCursor=function(e,r,o){n.validate(arguments,["string",["object","undefined"],"function"]);var i=t.defer();return c.transaction(e,"readonly",function(t){var n=t.objectStore(e).openCursor();n.onsuccess=function(){var e=n.result;return e?void o(e.value,function(){e.continue()}):i.resolve()},n.onerror=function(e){i.reject(e)}}),i};var v=void 0;Object.keys(v={onOpen:f,onUpgradeNeeded:l,onSocketConnected:h}).map(function(t){v[t].promise.done(function(n){var r=i+".v"+(s||1)+": "+t;n?e.error(r,n):e.log(r)}),c[t]=function(e){return n.validate(arguments,["function"]),v[t].promise.done(e),c}})}var u=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction,window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;return u?i:void alert("Su navegador no soporta una versión estable de indexedDB. Tal y como las características no serán validas")}n.$inject=["$log","qs","idbUtils","idbEvents","idbModel"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(e,t,n,r,o,i,u){"ngInject";var s=function(e,t,r){n.validate(arguments,["object","string","function"]);var o=t.split("."),i=o.pop();return function e(t){if(0==o.length)return r(t,i);var n=o.shift();return"undefined"==typeof t[n]&&(t[n]={}),e(t[n])}(e)},a=function(e,t){return s(e,t,function(e,t){return e[t]})},c=function(e,t,n){return s(e,t,function(e,t){e[t]=n}),e};return function(s,d,l){function f(e){var t=this;n.validate(arguments,[["object","undefined"]]),t.$resolved=!1,t.$loaded=!1,t.$localLoaded=!1,t.$remoteLoaded=!1,t.$localValues={},t.$remoteValues={},t.$version=null,t.$localVersion=null,t.$remoteVersion=null,t.$eventsHandlers={},e&&t.$setValues(e),t.$constructor(e),l&&t.$listen();var r=[];t.$bind(o.MODEL_QUERIED,function(e){r.push(e)}).$bind(o.MODEL_UNQUERIED,function(e){var t=r.indexOf(e);t!=-1&&r.splice(t,1)}).$emit(o.MODEL_INSTANCED)}n.validate(arguments,[null,"string"]);var h={keyPath:"id",autoIncrement:!0},p={},$={},v={},m=null,g=null;return f.getModelName=function(){return d},f.autoIncrement=function(e){return n.validate(arguments,["boolean"]),h.autoIncrement=e,f},f.keyPath=function(e){return n.validate(arguments,["string"]),h.keyPath=e,f},f.createStore=function(){return s.createStore(d,h),f},f.index=function(e,t,n){return s.createIndex(d,e,t,n),f},f.build=function(e){return n.validate(arguments,["function"]),e(f),f},f.fields=function(e){return n.validate(arguments,["object"]),v={},v[h.keyPath]={type:"number",required:!0},Object.keys(e).map(function(t){var n=e[t];"string"==typeof e[t]&&(n={type:n}),v[t]=n}),f},f.remote=function(e,t,r){return n.validate(arguments,["string","object","object"]),m=i(e,t,r),f},f.getRemote=function(){return m},f.getKeyFrom=function(e){return a(e,h.keyPath)},f.getInstance=function(e){return n.validate(arguments,[["string","number","undefined"]]),e?($[e]||($[e]=new f),$[e]):new f},f.get=function(n){var r=f.getInstance(n);if(r.$localLoaded)return r;var o=t.defer();return r.$resolved=!1,r.$promise=o.promise,s.get(d,n).promise.then(function(t){r.$resolved=!0,f.getVersionOf(n).promise.then(function(e){r.$setLocalValues(t,t&&e?e.hash:void 0),o.resolve(r)}).catch(function(t){o.resolve(r),e.error(["Model.getVersionOf any error",t])})}).catch(function(e){o.reject(e)}),r},f.find=function(e){return new r(s,f,e)},f.create=function(e){if(n.validate(arguments,["object",["function","undefined"]]),void 0===e.length){var r=f.getInstance(f.getKeyFrom(e));if(r.$loaded)throw new Error("Model.CantCreatedLoadedInstance");return r.$pull()}var o=Array.prototype.slice.call(e),i=[],u=t.defer(cb);return function e(){return 0==o.length?u.resolve(i):void f.create(o.shift()).then(function(t){i.push(t),e()}).catch(function(e){u.reject(e)})}(),u},f.versioning=function(e,t){return"function"==typeof e&&(t=e,e=void 0),n.validate([e,t],[["string","undefined"],["function","undefined"]]),g||(e||(e=d+"_versioning"),g=s.model(e).autoIncrement(!1).keyPath(h.keyPath).fields({hash:{type:"string",required:!0}})),t&&t(g),f},f.getVersionOf=function(e){var n=t.defer();return g?g.get(e).$promise.then(function(e){n.resolve(e)}).catch(function(){n.reject(null)}):n.resolve(null),n},f.bind=function(e,t){return n.validate(arguments,["string",["function","undefined"]]),p[e]||(p[e]=[]),p[e].push(t),f},f.emit=function(e,t){return n.validate(arguments,["string",["undefined","array"]]),p[e]&&p[e].map(function(e){e.apply(f,t||[])}),f},f.prototype.$get=function(e){return a(this,e)},f.prototype.$set=function(e,t){return a(this,e,t)},f.prototype.$getValues=function(e){n.validate(arguments,[["object","undefined"]]);var t={};return e=e||this,Object.keys(v).map(function(n){c(t,n,a(e,n))}),t},f.prototype.$getLocalValues=function(){return this.$getValues(this.$localValues)},f.prototype.$getRemoteValues=function(){return this.$getValues(this.$remoteValues)},f.prototype.$setValues=function(e,t){var r=this;return n.validate(arguments,["object",["string","undefined"]]),r.$version=t,Object.keys(e).map(function(t){c(r,t,e[t])}),r.$loaded=!0,r},f.prototype.$setLocalValues=function(e,t){var r=this;return n.validate(arguments,[["object","undefined"],["string","undefined"]]),r.$localVersion=t,Object.keys(e||{}).map(function(t){c(r.$localValues,t,e[t])}),e&&(r.$localLoaded=!0,r.$loaded||r.$setValues(e,t)),r},f.prototype.$setRemoteValues=function(e,t){var r=this;return n.validate(arguments,[["object","undefined"],["string","undefined"]]),r.$remoteVersion=t,Object.keys(e||{}).map(function(t){c(r.$remoteValues,t,e[t])}),e&&(r.$remoteLoaded=!0,r.$loaded||r.$setValues(e,t)),r},f.prototype.$setKey=function(e){var t=f.getKeyFrom(this);if(f.searchDeepField(this,h.keyPath,function(t,n){t[n]=e}),t!==e){if(t&&$[t]&&$[t]!=this)throw new Error("Model.InstanceOfOldKeyIsNotSame");if(e&&$[e]&&$[e]!=this)throw new Error("Model.InstanceOfNewKeyIsNotSame");t&&$[t]&&delete $[t],e&&!$[e]&&($[e]=this)}return this},f.prototype.$constructor=function(e){},f.prototype.$pull=function(e,r){var o=this;n.validate(arguments,[["object","undefined"],["string","undefined"]]);var i=t.defer();e=e?o.$getValues(e):o.$getRemoteValues();var u=f.getKeyFrom(e),s=o.$getLocalValues(),a=f.getKeyFrom(s);return console.log(u,a),console.log(e,s),i},f.prototype.$listen=function(){var e=this;if(!l)throw new Error("Model.DoesNotHaveSocketInstance");l.subscribe({modelName:d,eventName:"update",modelId:e.$get(h.keyPath)},function(t){u(function(){e.$setRemoteValues(t.values,t.version)})})},f.prototype.$bind=function(e,t){return n.validate(arguments,["string",["function","undefined"]]),this.$eventsHandlers[e]||(this.$eventsHandlers[e]=[]),this.$eventsHandlers[e].push(t),this},f.prototype.$emit=function(e,t){var r=this;return n.validate(arguments,["string",["undefined","array"]]),f.emit(e,[r,[].concat([r]).concat(t)]),r.$eventsHandlers[e]&&r.$eventsHandlers[e].map(function(e){e.apply(r,t||[])}),r},f.$instances=$,f}}n.$inject=["$log","qs","idbUtils","idbQuery","idbEvents","lbResource","$timeout"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(e,t,n,r){"ngInject";return function(o,i,u){var s=this;n.validate(arguments,["object","function",["object","undefined"]]);var a=null;s.getResult=function(s){var c=this;return n.validate(arguments,[["function","undefined"]]),a||!function(){var n=t.defer();a=[],a.$resolved=!1,a.$promise=n.promise,o.openCursor(i.getModelName(),u,function(t,o){var u=i.getKeyFrom(t),s=i.getInstance(u);return s.$localLoaded?o():void i.getVersionOf(u).promise.then(function(e){s.$setLocalValues(t,t&&e?e.hash:void 0),s.$resolved=!0,s.$emit(r.MODEL_QUERIED,[a]),a.push(s),o()}).catch(function(t){n.reject(t),e.error(["Model.getVersionOf any error",t])})}).promise.then(function(){a.$resolved=!0,n.resolve(a),c.getRemoteResult()}).catch(function(e){n.reject(e)})}(),a},s.getRemoteResult=function(){n.validate(arguments,[["function","undefined"]]);var e=i.getRemote(),t=null;return e&&"function"==typeof e.find&&(t=e.find(u).$promise).then(function(e){e.map(function(e,t){i.get(i.getKeyFrom(e.values)).$promise.then(function(n){n.$setRemoteValues(e.values,e.version),a[t]?(a[t]!==n&&a[t].$emit(r.MODEL_UNQUERIED,[a]),a[t]=n):a.push(n),n.$emit(r.MODEL_QUERIED,[a])})})}),t}}}n.$inject=["$log","qs","idbUtils","idbEvents"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(e){function t(e){var t=e.match(/^(?:https?:)?\/\/([^\/]+)/);return t?t[1]:null}var n=location.host,r=function e(){"ngInject";function t(e,t,n){try{var r=o+t;null==n&&(n=""),e[r]=n}catch(e){console.log("Cannot access local/session storage:",e)}}function n(e){var t=o+e;return localStorage[t]||sessionStorage[t]||null}function e(){var e=this;r.forEach(function(t){e[t]=n(t)}),e.currentUserData=null}var r=["accessTokenId","currentUserId","rememberMe"],o="$idb-lb$";return e.prototype.save=function(){var e=this,n=e.rememberMe?localStorage:sessionStorage;r.forEach(function(r){t(n,r,e[r])})},e.prototype.setUser=function(e,t,n){var r=this;r.accessTokenId=e,r.currentUserId=t,r.currentUserData=n},e.prototype.clearUser=function(){var e=this;e.accessTokenId=null,e.currentUserId=null,e.currentUserData=null},e.prototype.clearStorage=function(){r.forEach(function(e){t(sessionStorage,e,null),t(localStorage,e,null)})},new e},o=function(e,r){"ngInject";return{request:function(o){var i=t(o.url);if(i&&i!==n)return o;if(r.accessTokenId)o.headers[authHeader]=r.accessTokenId;else if(o.__isGetCurrentUser__){var u={body:{error:{status:401}},status:401,config:o,headers:function(){}};return e.reject(u)}return o||e.when(o)}}};o.$inject=["$q","lbAuth"];var i=function(){"ngInject";var e=this,r={urlBase:"/api",authHeader:"authorization"};n=t(r.urlBase)||location.host,e.setAuthHeader=function(e){r.authHeader=e},e.getAuthHeader=function(){return r.authHeader},e.setUrlBase=function(e){r.urlBase=e,n=t(r.urlBase)||location.host},e.getUrlBase=function(){return r.urlBase},e.$get=["$resource",function(e){var t=function(t,n,o){Object.keys(o).map(function(e){o[e].originalUrl=o[e].url,o[e].url=r.urlBase+o[e].url});var i=e(r.urlBase+t,n,o);return i.prototype.$save=function(e,t){var n=i.upsert.call(this,{},this,e,t);return n.$promise||n},i};return t.getUrlBase=function(){return r.urlBase},t.getAuthHeader=function(){return r.authHeader},t}]};return e.factory("lbAuth",r).provider("lbResource",i).factory("lbAuthRequestInterceptor",o).config(["$httpProvider",function(e){"ngInject";e.interceptors.push("lbAuthRequestInterceptor")}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var i=n(10),u=o(i),s=n(11),a=o(s),c=n(12),d=o(c),l=n(13),f=o(l),h=n(14),p=o(h),$=n(19),v=o($),m=n(15),g=o(m),y=n(16),b=o(y),j=n(17),I=o(j),w=n(18),_=o(w);(0,_.default)(angular.module("ng.v1.idb",[])).constant("io",io).service("Clazzer",u.default).constant("idbVersion","0.0.1").service("idbRequest",a.default).service("idbOpenDBRequest",d.default).service("idb2",f.default).service("idbStore",p.default).service("idbEventTarget",v.default).service("idbModel2",g.default).service("idbSocket2",b.default).service("idbTransaction",I.default).service("db2",["idb2",function(e){"ngInject";var t=new e("aaa",4);return t.$automigration({1:function(e){e.$model("Trabajador").$createStore()}}).$drop().then(function(e){e.$open().then(function(e){console.log(["opened"])})}),t}]).service("Trabajador2",["db2",function(e){"ngInject";return window.Trabajador2=e.$model("Trabajador").$field("cod",{type:"string",required:!0}).$field("ci",{type:"string",required:!0}).$field("nombres",{type:"string",required:!0}).$field("apellidos",{type:"string",required:!0}).$field("nacimiento",{type:"date"}).$field("ingreso",{type:"date"}).$field("direccion",{type:"string"}).$remote("/trabajadores/:id",{id:"@id"},{find:{url:"/trabajadores/_findWithVersion",method:"GET",isArray:!0}}).$build(function(e){e.prototype.$constructor=function(e){},e.prototype.getNombre=function(){return this.nombres+" "+this.apellidos}})}]).run(["db2","Trabajador2",function(e,t){"ngInject";var n=new t;n.nombres="Alexander",n.apellidos="Rondon",console.log(n.$getValues()),console.log(n.getNombre()),t.$put({id:1,nombres:"Alexander"}),t.$put({id:2,nombres:"Guillemo"}),t.$put({id:2,apellidos:"Seminario"}),t.$put({id:4,nombres:"Axel"}),t.$put({nombres:"Gabriel"}),window.r=t.$get(2),r.$promise.then(function(e){console.log(["then",e])}).catch(function(e){console.error(e)})}])},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){"ngInject";function e(e){Object.defineProperty(this,"clazz",{value:e||function(){}})}return Object.defineProperty(e.prototype,"inherit",{value:function(e){var t=function(){};return t.prototype=e.prototype,this.clazz.prototype=new t,this.clazz.prototype.constructor=this.clazz,this}}),Object.defineProperty(e.prototype,"static",{value:function(e,t){return Object.defineProperty(this.clazz,e,{value:t}),this}}),Object.defineProperty(e.prototype,"property",{value:function(e,t){return Object.defineProperty(this.clazz.prototype,e,t),this}}),Object.defineProperty(e.prototype,"method",{value:function(e,t){return this.property(e,{value:t}),this}}),Object.defineProperty(e.prototype,"getter",{value:function(e,t){return t||(t=e),this.property(e,{get:function(){return this.$me[t]}}),this}}),Object.defineProperty(e.prototype,"setter",{value:function(e,t){return t||(t=e),this.property(e,{set:function(e){this.$me[t]=e}}),this}}),Object.defineProperty(e.prototype,"handlerEvent",{value:function(e,t){return t||(t=e),this.property(e,{value:function(e){return this.$me[t]=e,this}}),this}}),e}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Clazzer",function(e){"ngInject";var t=new e({}).static("Pending","pending").static("Done","done");return new e(function(t){new e(this).static("$me",t)}).inherit(EventTarget).static("ReadyState",t.clazz).getter("$result","result").getter("$error","error").getter("$source","source").getter("$readyState","readyState").getter("$transaction","transaction").handlerEvent("$success","onsuccess").handlerEvent("$fail","onerror").property("$promise",{get:function(){var t=this;return t.$_promise?t.$_promise:(t.$_promise=new Promise(function(e,n){t.$success(function(t){e(t)}).$fail(function(e){n(e)})}),new e(t.$_promise).static("$request",t),t.$_promise)}}).clazz}]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Clazzer","idbRequest",function(e,t){"ngInject";return new e(function(e){t.apply(this,arguments)}).inherit(t).handlerEvent("$blocked","onblocked").handlerEvent("$upgradeneeded","onupgradeneeded").clazz}]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Clazzer","idbEventTarget","idbStore","idbModel2","idbOpenDBRequest","idbTransaction","$log",function(e,t,n,r,o,i,u){"ngInject";var s=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction,window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;if(!s)return void alert("Su navegador no soporta una versión estable de indexedDB. Tal y como las características no serán validas");var a=function(t,n,r){new e(this).static("$name",t).static("$version",n).static("$socket",r)};return new e(a).inherit(t).property("$_upgradeneededs",{value:[]}).property("$_models",{value:{}}).getter("$objectStoreNames","objectStoreNames").handlerEvent("$aborted","onabort").handlerEvent("$closed","onclose").handlerEvent("$error","onerror").handlerEvent("$versionChanged","onversionchange").static("$open",function(e,t){return new o(s.open(e,t))}).static("$drop",function(e){return new o(s.deleteDatabase(e))}).static("$cmp",function(e,t){return s.cmp(e,t)}).method("$upgradeneeded",function(e){return this.$_upgradeneededs.push(e),this}).method("$automigration",function(e){return this.$upgradeneeded(function(t,n,r){Object.keys(e).map(function(o){if(r.oldVersion<o&&o<=r.newVersion){var i=Array.isArray(e[o])?e[o]:[e[o]];u.log("migration v"+o+" starts"),i.map(function(e){e(t,n,r)}),u.log("migration v"+o+" ends")}})})}).method("$open",function(e,t){var n=this,r=null,o=null;return n.$opened?e&&e(n,r,o):n.$opened=(r=a.$open(n.$name,n.$version).$upgradeneeded(function(e){n.$me=e.target.result,n.$_upgradeneededs.map(function(t){t.apply(n,[n,r,e])})})).$promise.then(function(t){return n.$me=t.target.result,o=t,e&&e(n,r,t),n}).catch(function(e){return r=null,n.$opened=null,t&&t(n,r,e),n}),n.$opened}).method("$drop",function(e){var t=this;return t.$opened=null,new Promise(function(n,r){var o=a.$drop(t.$name).$success(function(e){n(t)}).$fail(function(e){r(e)});e&&e(o)})}).method("$close",function(){this.$me.close()}).method("$createStore",function(e,t){return new n(this.$me.createObjectStore(e,t))}).method("$dropStore",function(e){this.$me.deleteObjectStore(e)}).method("$model",function(e,t){return this.$_models[e]?this.$_models[e]:this.$_models[e]=r(this,e,t||this.$socket)}).method("$transaction",function(e,t){var n=this;return new Promise(function(r,o){n.$open().then(function(n){r(new i(n.$me.transaction(e,t)))}).catch(function(e){o(e)})})}).method("$store",function(t){function n(e){return function(n){return new Promise(function(o,i){r.$transaction(t,e).then(function(e){var i={},u=t.map(function(t){return i[t]=e.$store(t)});n&&n.apply(r,u),o(i)}).catch(function(e){i(e)})})}}var r=this;return Array.isArray(t)||(t=[t]),new e({}).static("$reader",n(i.TransactionMode.ReadOnly)).static("$writer",n(i.TransactionMode.ReadWrite)).clazz}).clazz}]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Clazzer","idbRequest",function(e,t){"ngInject";return new e(function(t){new e(this).static("$me",t)}).getter("$name","name").getter("$keyPath","keyPath").getter("$indexNames","indexNames").getter("$transaction","transaction").getter("$autoIncrement","autoIncrement").method("$put",function(e,n){return new t(this.$me.put(e,n))}).method("$add",function(e,n){return new t(this.$me.add(e,n))}).method("$delete",function(e){return new t(this.$me.delete(e))}).method("$clear",function(){return new t(this.$me.clear())}).method("$get",function(e){return new t(this.$me.get(e))}).method("$getKey",function(e){return new t(this.$me.getKey(e))}).method("$getAll",function(e,n){return new t(this.$me.getAll(e,n))}).method("$getAllKeys",function(e,n){return new t(this.$me.getAllKeys(e,n))}).method("$count",function(e){return new t(this.$me.count(e))}).method("$openCursor",function(e,n){return new t(this.$me.openCursor(e,n))}).method("$openKeyCursor",function(e,n){return new t(this.$me.openKeyCursor(e,n))}).method("$index",function(e){throw"idbStore.method.$index"}).method("$createIndex",function(e,t,n){throw"idbStore.method.$createIndex"}).method("$deleteIndex",function(e){this.$me.deleteIndex(e)}).clazz}]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Clazzer","idbEventTarget","lbResource","$timeout",function(e,t,n,r){"ngInject";var o=function(e,t,n){var r=t.split("."),o=r.pop();return function e(t){if(0==r.length)return n(t,o);var i=r.shift();return"undefined"==typeof t[i]&&(t[i]={}),e(t[i])}(e)},i=function(e,t){return o(e,t,function(e,t){return e[t]})},u=function(e,t,n){return o(e,t,function(e,t){e[t]=n}),e};return function(o,s,a){function c(){}return new e(c).inherit(t).static("$db",o).static("$name",s).static("$socket",a).static("$id",{keyPath:"id",autoIncrement:!0}).static("$fields",{id:{id:!0,name:"id",type:"number"}}).static("$instances",{}).static("$getKeyFrom",function(e){return i(e,this.$id.keyPath)}).static("$createStore",function(e){var t=this.$db.$createStore(this.$name,this.$id);return e&&e(this,t),this}).static("$writer",function(e){var t=this;return t.$db.$store(t.$name).$writer(e).then(function(e){return e[t.$name]})}).static("$reader",function(e){var t=this;return t.$db.$store(t.$name).$reader(e).then(function(e){return e[t.$name]})}).static("$put",function(e,t){var n=this,r=this.$getValues(e);return n.$writer().then(function(e){return e.$put(r,t).$promise.then(function(e){var t=n.$getInstance(e.target.result);return t.$setLocalValues(r),t})})}).static("$add",function(e,t){var n=this,r=this.$getValues(e);return n.$writer().then(function(e){return e.$add(r,t).$promise.then(function(e){var t=n.$getInstance(e.target.result);return t.$setLocalValues(r),t})})}).static("$delete",function(e){throw"idbModel.static.$delete"}).static("$clear",function(){throw"idbModel.static.$clear"}).static("$get",function(e){var t=this,n=this.$getInstance(e);return n.$promise=t.$reader().then(function(t){return t.$get(e).$promise.then(function(e){return n.$setLocalValues(e.target.result),n})}),n}).static("$getKey",function(e){throw"idbModel.static.$getKey"}).static("$getAll",function(e,t){throw"idbModel.static.$getAll"}).static("$getAllKeys",function(e,t){throw"idbModel.static.$getAllKeys"}).static("$count",function(e){throw"idbModel.static.$count"}).static("$getInstance",function(e){return void 0===e||null===e?new this:(this.$instances[e]||(this.$instances[e]=new this,this.$instances[e].$set(this.$id.keyPath,e)),this.$instances[e])}).static("$field",function(e,t){return"string"==typeof t&&(t={type:t}),t.name=e,this.$fields[e]=t,this}).static("$key",function(e,t,n){return"boolean"==typeof e&&(t=e),void 0!==e&&null!==e&&"boolean"!=typeof e||(e="id"),"string"==typeof t&&(n=t,t=null),void 0!==t&&null!==t||(t=!0),"boolean"!=typeof t&&"string"===n||(n="number"),this.$id.keyPath=e,this.$id.autoIncrement=t,this.$field(e,{id:!0,type:n})}).static("$getValues",function(e){var t={};return Object.keys(this.$fields).map(function(n){var r=i(e,n);void 0!==r&&u(t,n,r)}),t}).static("$build",function(e){return e(this),this}).static("$remote",function(e,t,r){return this.$_remote=n(e,t,r),this}).property("$_values",{value:new e({}).static("local",{}).static("remote",{}).clazz}).property("$_versions",{value:{}}).method("$get",function(e){return i(this,e)}).method("$set",function(e,t){return u(this,e)}).method("$getValues",function(e){return c.$getValues(e||this)}).method("$getLocalValues",function(){return this.$getValues(this.$_values.local)}).method("$getRemoteValues",function(){return this.$getValues(this.$_values.remote)}).method("$setValues",function(e){var t=this;return Object.keys(e||{}).map(function(n){u(t,n,e[n])}),t}).method("$setLocalValues",function(e){var t=this;return Object.keys(e||{}).map(function(n){u(t.$_values.local,n,e[n])}),t}).method("$setRemoteValues",function(e){var t=this;return Object.keys(e||{}).map(function(n){u(t.$_values.remote,n,e[n])}),t}).method("$key",function(e){return i(e,this.$id.keyPath)}).method("$listen",function(e){var t=this;if(!this.$socket)throw new Error("idbModel.DoesNotHaveSocketInstance");this.$socket.subscribe({modelName:c.$name,eventName:"update",modelId:t.$key()},function(e){r(function(){t.$setRemoteValues(e.values,e.version)})})}).clazz}}]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Clazzer","io","$log",function(e,t,n){"ngInject";var r=function t(n,r,o){new e(this).static("$url",n||t.$defUrlServer).static("$accessTokenId",accessTokenId||t.$defAccessTokenId).static("$currentUserId",currentUserId||t.$defCurrentUserId),thiz.$connect()};return new e(r).property("$_listeners",{value:[]}).method("$connect",function(){var e=this.$socket=t.connect($url);e.on("connect",function(){n.log("connected"),e.emit("authentication",{id:this.$accessTokenId,userId:this.$currentUserId}),e.on("authenticated",function(){n.log("User is authenticated")})})}).method("$subscribe",function(e,t){var n=e.modelName+"."+e.eventName;"number"==typeof e.modelId&&(n=n+"."+e.modelId),this.$socket.on(n,t),this.$pushListener(n,t)}).method("$pushListener",function(e,t){this.$_listeners.push(e)}).method("$unsubscribe",function(e){this.$socket.removeAllListeners(e);var t=this.$_listeners.indexOf(e);t!=-1&&this.$_listeners.splice(t,1)}).static("$setUrlServer",function(e){return this.$defUrlServer=e,this}).static("$setCredentials",function(e,t){return this.$defAccessTokenId=e,this.$defCurrentUserId=t,this}).clazz.$setUrlServer(null).$setCredentials(null,null)}]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Clazzer","idbStore",function(e,t){"ngInject";var n=new e({}).static("ReadOnly","readonly").static("ReadWrite","readwrite").static("VersionChange","versionchange");return new e(function(t){new e(this).static("$me",t)}).inherit(EventTarget).static("TransactionMode",n.clazz).getter("$db","db").getter("$mode","mode").getter("$error","error").getter("$objectStoreNames","objectStoreNames").handlerEvent("$aborted","onabort").handlerEvent("$completed","oncomplete").handlerEvent("$fail","onerror").method("$store",function(e){return new t(this.$me.objectStore(e))}).method("$abort",function(){this.$me.abort()}).property("$promise",{get:function(){var t=this;return t.$_promise?t.$_promise:(t.$_promise=new Promise(function(e,n){t.$completed(function(t){e(t)}).$fail(function(e){n(e)})}),new e(t.$_promise).static("$transaction",t),t.$_promise)}}).clazz}]},function(e,t){"use strict";function n(e){function t(e){var t=e.match(/^(?:https?:)?\/\/([^\/]+)/);return t?t[1]:null}var n=location.host,r=function e(){"ngInject";function t(e,t,n){try{var r=o+t;null==n&&(n=""),e[r]=n}catch(e){console.log("Cannot access local/session storage:",e)}}function n(e){var t=o+e;return localStorage[t]||sessionStorage[t]||null;
}function e(){var e=this;r.forEach(function(t){e[t]=n(t)}),e.currentUserData=null}var r=["accessTokenId","currentUserId","rememberMe"],o="$idb-lb$";return e.prototype.save=function(){var e=this,n=e.rememberMe?localStorage:sessionStorage;r.forEach(function(r){t(n,r,e[r])})},e.prototype.setUser=function(e,t,n){var r=this;r.accessTokenId=e,r.currentUserId=t,r.currentUserData=n},e.prototype.clearUser=function(){var e=this;e.accessTokenId=null,e.currentUserId=null,e.currentUserData=null},e.prototype.clearStorage=function(){r.forEach(function(e){t(sessionStorage,e,null),t(localStorage,e,null)})},new e},o=function(e,r){"ngInject";return{request:function(o){var i=t(o.url);if(i&&i!==n)return o;if(r.accessTokenId)o.headers[authHeader]=r.accessTokenId;else if(o.__isGetCurrentUser__){var u={body:{error:{status:401}},status:401,config:o,headers:function(){}};return e.reject(u)}return o||e.when(o)}}};o.$inject=["$q","lbAuth"];var i=function(){"ngInject";var e=this,r={urlBase:"/api",authHeader:"authorization"};n=t(r.urlBase)||location.host,e.setAuthHeader=function(e){r.authHeader=e},e.getAuthHeader=function(){return r.authHeader},e.setUrlBase=function(e){r.urlBase=e,n=t(r.urlBase)||location.host},e.getUrlBase=function(){return r.urlBase},e.$get=["$resource",function(e){var t=function(t,n,o){Object.keys(o).map(function(e){o[e].originalUrl=o[e].url,o[e].url=r.urlBase+o[e].url});var i=e(r.urlBase+t,n,o);return i.prototype.$save=function(e,t){var n=i.upsert.call(this,{},this,e,t);return n.$promise||n},i};return t.getUrlBase=function(){return r.urlBase},t.getAuthHeader=function(){return r.authHeader},t}]};return e.factory("lbAuth",r).provider("lbResource",i).factory("lbAuthRequestInterceptor",o).config(["$httpProvider",function(e){"ngInject";e.interceptors.push("lbAuthRequestInterceptor")}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Clazzer",function(e){"ngInject";return new e(function(){}).property("$_listeners",{value:[]}).method("$bind",function(e,t){e in this.$_listeners||(this.$_listeners[e]=[]),this.$_listeners[e].push(t)}).method("$unbind ",function(e,t){if(e in this.$_listeners)for(var n=this.$_listeners[e],r=0,o=n.length;r<o;r++)if(n[r]===t)return n.splice(r,1),this.$unbind(e,t)}).method("$emit",function(e){if(e.type in this.$_listeners)for(var t=this.$_listeners[e.type],n=0,r=t.length;n<r;n++)t[n].call(this,e)}).clazz}]}]);